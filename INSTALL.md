# Typecho 导航主题 - 安装指南

## 前置要求

- Typecho 1.0 或更高版本
- PHP 5.4 或更高版本
- 支持 curl 或 fopen 的 PHP 环境（用于获取 Favicon）

## 安装步骤

### 方法一：直接上传（推荐）

1. **下载主题文件**
   - 下载本主题的所有文件

2. **上传到服务器**
   - 将整个主题文件夹上传到 `/usr/themes/` 目录
   - 文件夹名称应为 `typecho-nav-theme`
   - 最终路径应为：`/usr/themes/typecho-nav-theme/`

3. **在后台启用**
   - 登录 Typecho 后台
   - 进入 **设置 → 外观**
   - 找到 **导航主题**
   - 点击 **启用**

### 方法二：使用 Git 克隆

```bash
cd /path/to/typecho/usr/themes/
git clone https://github.com/yourusername/typecho-nav-theme.git
```

然后在后台启用主题。

## 主题文件说明

| 文件 | 说明 |
|------|------|
| `theme.php` | 主题配置文件，包含主题信息 |
| `index.php` | 主模板文件，前台展示 |
| `functions.php` | 主题功能函数 |
| `style.css` | 主题样式表 |
| `admin-fields.php` | 后台自定义字段管理 |
| `Plugin.php` | 辅助插件（可选） |
| `README.md` | 功能说明文档 |
| `INSTALL.md` | 本安装指南 |

## 配置主题

### 1. 创建分类

为了更好地组织网站导航，建议创建以下分类：

**在后台操作：**
1. 进入 **管理 → 分类**
2. 点击 **新增分类**
3. 创建以下分类：

| 分类名 | 描述 |
|--------|------|
| 动漫 | 动漫相关网站 |
| 漫画 | 漫画相关网站 |
| 下载 | 下载资源网站 |
| 神器 | 实用工具网站 |
| 影视 | 影视相关网站 |
| 音乐 | 音乐相关网站 |
| 阅读 | 阅读相关网站 |
| 游戏 | 游戏相关网站 |
| 娱乐 | 娱乐相关网站 |

### 2. 添加网站导航

**在后台操作：**
1. 进入 **管理 → 写文章**
2. 填写以下信息：

#### 基本信息
- **文章标题**：网站名称（如 "AniCh动漫弹幕网"）
- **文章分类**：选择对应的分类
- **文章内容**：可选，可以写网站的详细介绍

#### 导航主题字段
在文章编辑页面下方，您会看到 **导航主题字段** 部分：

**网站 URL**
- 输入网站的完整 URL，例如：`https://www.anichi.com`
- 这个字段用于自动获取网站的 Favicon

**网站图标**
- 点击 **自动获取图标** 按钮
- 系统会自动从网站获取 Favicon 并显示预览
- 如果自动获取失败，可以手动上传图标

**阿里图标代码**
- 输入阿里 Iconfont 的图标代码，例如：`icon-star`
- 这个图标会显示在卡片的右上角
- 可选字段

**平台标识**
- 输入网站支持的平台，用逗号分隔
- 例如：`iOS, Android, Web`
- 这些标识会显示在卡片底部

**网站简介**
- 输入网站的简短介绍，最多 100 字
- 例如：`高清片源的追番平台，支持弹幕追番`
- 这个描述会显示在卡片中

3. 点击 **发布** 保存

## 配置阿里 Iconfont

如果要使用阿里 Iconfont 图标，需要进行以下配置：

### 1. 创建 Iconfont 项目

1. 访问 [Iconfont](https://www.iconfont.cn/)
2. 注册/登录账号
3. 创建新项目或选择现有项目
4. 添加所需的图标

### 2. 获取 CDN 链接

1. 在 Iconfont 项目中，找到 **生成链接** 或 **复制代码**
2. 复制 CSS 链接，格式如下：
   ```
   https://at.alicdn.com/t/font_1234567890_abcdefg.css
   ```

### 3. 配置主题

1. 编辑主题文件夹中的 `index.php`
2. 找到以下行（大约在第 11 行）：
   ```html
   <link rel="stylesheet" href="https://at.alicdn.com/t/font_1234567890_abcdefg.css">
   ```
3. 替换为您的 Iconfont CDN 链接
4. 保存文件

### 4. 在文章中使用

在编辑文章时，在 **阿里图标代码** 字段中输入图标代码，例如：
- `icon-star` - 星星图标
- `icon-heart` - 心形图标
- `icon-download` - 下载图标
- 等等

## 自动获取 Favicon 功能

主题内置了自动获取网站 Favicon 的功能。

### 工作原理

1. 在后台编辑文章时，输入网站 URL
2. 点击 **自动获取图标** 按钮
3. 系统调用 Google Favicon API 获取网站图标
4. 获取成功后，图标会显示在预览框中
5. 发布文章后，前台会显示该图标

### 支持的 URL 格式

- `https://example.com` ✓
- `http://example.com` ✓
- `example.com` ✓（会自动添加 https://）
- `www.example.com` ✓

### 如果获取失败

1. 检查 URL 是否正确
2. 确保目标网站可以正常访问
3. 检查服务器是否允许外部 HTTP 请求
4. 可以手动上传图标作为备选方案

## 常见问题

### Q: 如何修改主题颜色？

A: 编辑 `style.css` 文件，修改 CSS 变量：

```css
:root {
    --color-bg: #1a1a1a;           /* 背景色 */
    --color-card: #2d2d2d;         /* 卡片背景色 */
    --color-text: #e8e8e8;         /* 文字色 */
    --color-accent: #4a9eff;       /* 强调色 */
}
```

### Q: 如何修改卡片的宽度？

A: 编辑 `style.css` 文件，修改 `.cards-grid` 的 `grid-template-columns`：

```css
.cards-grid {
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
}
```

将 `280px` 改为您想要的宽度。

### Q: 如何隐藏左侧导航栏？

A: 编辑 `style.css` 文件，修改 `.sidebar` 的 `display`：

```css
.sidebar {
    display: none;
}
```

### Q: 如何修改卡片的圆角大小？

A: 编辑 `style.css` 文件，修改 `--radius-lg` 变量：

```css
:root {
    --radius-lg: 1.5rem;  /* 改为您想要的值 */
}
```

### Q: 主题支持多语言吗？

A: 目前主题主要支持中文。如需支持其他语言，可以编辑相应的文本字符串。

### Q: 如何删除某个分类？

A: 在后台 **管理 → 分类** 中，选择要删除的分类，点击 **删除** 即可。

### Q: 如何修改每页显示的文章数？

A: 这个设置在 Typecho 的 **设置 → 阅读** 中，修改 **每页文章数** 即可。

## 故障排除

### 问题：主题启用后页面显示不正常

**解决方案：**
1. 清除浏览器缓存
2. 检查 `style.css` 是否正确上传
3. 检查主题文件夹权限是否正确（应为 755）

### 问题：自动获取 Favicon 不工作

**解决方案：**
1. 检查 PHP 环境是否支持 curl 或 fopen
2. 检查服务器防火墙是否允许外部请求
3. 尝试手动输入 Favicon URL

### 问题：自定义字段不显示

**解决方案：**
1. 确保主题已正确启用
2. 检查 `functions.php` 是否正确加载
3. 尝试重新启用主题

### 问题：图标显示不出来

**解决方案：**
1. 检查 Iconfont CDN 链接是否正确
2. 检查图标代码是否正确
3. 检查浏览器控制台是否有错误信息

## 技术支持

如有问题，请：
1. 检查本文档的常见问题部分
2. 查看主题的 README.md 文件
3. 提交 Issue 或联系作者

## 许可证

本主题采用 MIT 许可证。详见 LICENSE 文件。

---

**最后更新**：2024-01-05
